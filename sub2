{
  "log": {
    "level": "info"
  },

  "dns": {
    "strategy": "prefer_ipv4",
    "final": "remote-dns",
    "servers": [
      {
        "tag": "local-dns",
        "address": "223.5.5.5",
        "detour": "direct"
      },
      {
        "tag": "remote-dns",
        "address": "1.1.1.1",
        "detour": "direct"
      }
    ],
    "rules": [
      { "geosite": ["cn"], "server": "local-dns" },
      { "domain_suffix": ["lan", "local"], "server": "local-dns" }
    ]
  },

  "inbounds": [
    {
      "type": "mixed",
      "tag": "mixed-in",
      "listen": "127.0.0.1",
      "listen_port": 7890,
      "sniff": true, 
      "sniff_override_destination": true
    }
  ],

  "outbounds": [
    {
      "type": "vless",
      "tag": "proxy",
      "server": "mathbushnis2.netlib.re",
      "server_port": 62789,
      "uuid": "e848aa55-4be7-4769-f367-c84fabd54960",
      "flow": "",
      "tls": {
        "enabled": true,
        "server_name": "mathbushnis2.netlib.re",
        "insecure": false
      },
      "transport": {
        "type": "ws",
        "path": "/ws",
        "headers": {
          "Host": "mathbushnis2.netlib.re"
        }
      }
    },
    {
      "type": "direct",
      "tag": "direct"
    },
    {
      "type": "block",
      "tag": "block"
    },
    {
      "type": "dns",
      "tag": "dns"
    }
  ],

  "route": {
    "domain_strategy": "prefer_ipv4",
    "auto_detect_interface": true,

    "geoip": {
      "download_url": "https://raw.githubusercontent.com/SagerNet/sing-geoip/rule-set/geoip.db"
    },
    "geosite": {
      "download_url": "https://raw.githubusercontent.com/SagerNet/sing-geosite/rule-set/geosite.db"
    },

    "final": "proxy",
    "rules": [
      { "protocol": ["dns"], "outbound": "dns" },

      { "geoip": ["private"], "outbound": "direct" },

      { "geoip": ["cn"], "outbound": "direct" },
      { "geosite": ["cn"], "outbound": "direct" },

      { "geosite": ["geolocation-!cn"], "outbound": "proxy" }
    ]
  }
}
